{"ast":null,"code":"import { Flight, FlightStats, DelayByHour } from '../../entities/flight/flight.types';\nexport const calculateFlightStats = flights => {\n  let onTime = 0;\n  let delayed = 0;\n  let canceled = 0;\n  let inAir = 0;\n  const delayByHour = {};\n  flights.forEach(flight => {\n    var _flight$delay_categor;\n\n    const dc = ((_flight$delay_categor = flight.delay_category) === null || _flight$delay_categor === void 0 ? void 0 : _flight$delay_categor.toLowerCase()) || ''; // Статистика по категориям\n\n    if (dc === 'отменен' || dc === 'отменено' || dc === 'canceled') {\n      canceled++;\n    } else if (dc === 'нет_задержки' || dc === 'нет задержки') {\n      onTime++;\n    } else if (dc) {\n      delayed++;\n    } // Рейсы в воздухе\n\n\n    if (flight.fact_departure && !flight.fact_arrival) {\n      inAir++;\n    } // Статистика по часам\n\n\n    if (flight.plan_departure) {\n      const dt = new Date(flight.plan_departure);\n      const hourStr = dt.getHours().toString().padStart(2, '0') + ':00';\n\n      if (!delayByHour[hourStr]) {\n        delayByHour[hourStr] = {\n          onTime: 0,\n          delayed: 0,\n          canceled: 0\n        };\n      }\n\n      if (dc === 'отменен' || dc === 'отменено' || dc === 'canceled') {\n        delayByHour[hourStr].canceled++;\n      } else if (dc === 'нет_задержки' || dc === 'нет задержки') {\n        delayByHour[hourStr].onTime++;\n      } else if (dc) {\n        delayByHour[hourStr].delayed++;\n      }\n    }\n  });\n  const hourlyStats = Object.entries(delayByHour).sort((a, b) => a[0].localeCompare(b[0])).map(([time, counts]) => ({\n    time,\n    ...counts\n  }));\n  return {\n    summary: {\n      onTime,\n      delayed,\n      canceled,\n      inAir\n    },\n    hourlyStats\n  };\n};","map":{"version":3,"sources":["/Users/emiliamamedova/flight-1/src/shared/lib/calculateStats.utils.jsx"],"names":["Flight","FlightStats","DelayByHour","calculateFlightStats","flights","onTime","delayed","canceled","inAir","delayByHour","forEach","flight","dc","delay_category","toLowerCase","fact_departure","fact_arrival","plan_departure","dt","Date","hourStr","getHours","toString","padStart","hourlyStats","Object","entries","sort","a","b","localeCompare","map","time","counts","summary"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,WAAjB,EAA8BC,WAA9B,QAAiD,oCAAjD;AAEA,OAAO,MAAMC,oBAAoB,GAAIC,OAAD,IAG/B;AACH,MAAIC,MAAM,GAAG,CAAb;AACA,MAAIC,OAAO,GAAG,CAAd;AACA,MAAIC,QAAQ,GAAG,CAAf;AACA,MAAIC,KAAK,GAAG,CAAZ;AACA,QAAMC,WAAkF,GAAG,EAA3F;AAEAL,EAAAA,OAAO,CAACM,OAAR,CAAgBC,MAAM,IAAI;AAAA;;AACxB,UAAMC,EAAE,GAAG,0BAAAD,MAAM,CAACE,cAAP,gFAAuBC,WAAvB,OAAwC,EAAnD,CADwB,CAGxB;;AACA,QAAIF,EAAE,KAAK,SAAP,IAAoBA,EAAE,KAAK,UAA3B,IAAyCA,EAAE,KAAK,UAApD,EAAgE;AAC9DL,MAAAA,QAAQ;AACT,KAFD,MAEO,IAAIK,EAAE,KAAK,cAAP,IAAyBA,EAAE,KAAK,cAApC,EAAoD;AACzDP,MAAAA,MAAM;AACP,KAFM,MAEA,IAAIO,EAAJ,EAAQ;AACbN,MAAAA,OAAO;AACR,KAVuB,CAYxB;;;AACA,QAAIK,MAAM,CAACI,cAAP,IAAyB,CAACJ,MAAM,CAACK,YAArC,EAAmD;AACjDR,MAAAA,KAAK;AACN,KAfuB,CAiBxB;;;AACA,QAAIG,MAAM,CAACM,cAAX,EAA2B;AACzB,YAAMC,EAAE,GAAG,IAAIC,IAAJ,CAASR,MAAM,CAACM,cAAhB,CAAX;AACA,YAAMG,OAAO,GAAGF,EAAE,CAACG,QAAH,GAAcC,QAAd,GAAyBC,QAAzB,CAAkC,CAAlC,EAAqC,GAArC,IAA4C,KAA5D;;AAEA,UAAI,CAACd,WAAW,CAACW,OAAD,CAAhB,EAA2B;AACzBX,QAAAA,WAAW,CAACW,OAAD,CAAX,GAAuB;AAAEf,UAAAA,MAAM,EAAE,CAAV;AAAaC,UAAAA,OAAO,EAAE,CAAtB;AAAyBC,UAAAA,QAAQ,EAAE;AAAnC,SAAvB;AACD;;AAED,UAAIK,EAAE,KAAK,SAAP,IAAoBA,EAAE,KAAK,UAA3B,IAAyCA,EAAE,KAAK,UAApD,EAAgE;AAC9DH,QAAAA,WAAW,CAACW,OAAD,CAAX,CAAqBb,QAArB;AACD,OAFD,MAEO,IAAIK,EAAE,KAAK,cAAP,IAAyBA,EAAE,KAAK,cAApC,EAAoD;AACzDH,QAAAA,WAAW,CAACW,OAAD,CAAX,CAAqBf,MAArB;AACD,OAFM,MAEA,IAAIO,EAAJ,EAAQ;AACbH,QAAAA,WAAW,CAACW,OAAD,CAAX,CAAqBd,OAArB;AACD;AACF;AACF,GAlCD;AAoCA,QAAMkB,WAAW,GAAGC,MAAM,CAACC,OAAP,CAAejB,WAAf,EACjBkB,IADiB,CACZ,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,CAAC,CAAD,CAAD,CAAKE,aAAL,CAAmBD,CAAC,CAAC,CAAD,CAApB,CADE,EAEjBE,GAFiB,CAEb,CAAC,CAACC,IAAD,EAAOC,MAAP,CAAD,MAAqB;AACxBD,IAAAA,IADwB;AAExB,OAAGC;AAFqB,GAArB,CAFa,CAApB;AAOA,SAAO;AACLC,IAAAA,OAAO,EAAE;AAAE7B,MAAAA,MAAF;AAAUC,MAAAA,OAAV;AAAmBC,MAAAA,QAAnB;AAA6BC,MAAAA;AAA7B,KADJ;AAELgB,IAAAA;AAFK,GAAP;AAID,CAzDM","sourcesContent":["import { Flight, FlightStats, DelayByHour } from '../../entities/flight/flight.types';\n\nexport const calculateFlightStats = (flights: Flight[]): {\n  summary: FlightStats;\n  hourlyStats: DelayByHour[];\n} => {\n  let onTime = 0;\n  let delayed = 0;\n  let canceled = 0;\n  let inAir = 0;\n  const delayByHour: Record<string, { onTime: number; delayed: number; canceled: number }> = {};\n\n  flights.forEach(flight => {\n    const dc = flight.delay_category?.toLowerCase() || '';\n    \n    // Статистика по категориям\n    if (dc === 'отменен' || dc === 'отменено' || dc === 'canceled') {\n      canceled++;\n    } else if (dc === 'нет_задержки' || dc === 'нет задержки') {\n      onTime++;\n    } else if (dc) {\n      delayed++;\n    }\n\n    // Рейсы в воздухе\n    if (flight.fact_departure && !flight.fact_arrival) {\n      inAir++;\n    }\n\n    // Статистика по часам\n    if (flight.plan_departure) {\n      const dt = new Date(flight.plan_departure);\n      const hourStr = dt.getHours().toString().padStart(2, '0') + ':00';\n\n      if (!delayByHour[hourStr]) {\n        delayByHour[hourStr] = { onTime: 0, delayed: 0, canceled: 0 };\n      }\n      \n      if (dc === 'отменен' || dc === 'отменено' || dc === 'canceled') {\n        delayByHour[hourStr].canceled++;\n      } else if (dc === 'нет_задержки' || dc === 'нет задержки') {\n        delayByHour[hourStr].onTime++;\n      } else if (dc) {\n        delayByHour[hourStr].delayed++;\n      }\n    }\n  });\n\n  const hourlyStats = Object.entries(delayByHour)\n    .sort((a, b) => a[0].localeCompare(b[0]))\n    .map(([time, counts]) => ({\n      time,\n      ...counts,\n    }));\n\n  return {\n    summary: { onTime, delayed, canceled, inAir },\n    hourlyStats\n  };\n};"]},"metadata":{},"sourceType":"module"}